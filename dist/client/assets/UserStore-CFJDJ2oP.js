import{q as H}from"./main-DZWvjlLQ.js";function R(i,c){let r;try{r=i()}catch{return}return{getItem:o=>{var e;const m=d=>d===null?null:JSON.parse(d,void 0),l=(e=r.getItem(o))!=null?e:null;return l instanceof Promise?l.then(m):m(l)},setItem:(o,e)=>r.setItem(o,JSON.stringify(e,void 0)),removeItem:o=>r.removeItem(o)}}const S=i=>c=>{try{const r=i(c);return r instanceof Promise?r:{then(n){return S(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return S(n)(r)}}}},w=(i,c)=>(r,n,o)=>{let e={storage:R(()=>localStorage),partialize:t=>t,version:0,merge:(t,v)=>({...v,...t}),...c},m=!1;const l=new Set,d=new Set;let u=e.storage;if(!u)return i((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${e.name}', the given storage is currently unavailable.`),r(...t)},n,o);const y=()=>{const t=e.partialize({...n()});return u.setItem(e.name,{state:t,version:e.version})},_=o.setState;o.setState=(t,v)=>(_(t,v),y());const h=i((...t)=>(r(...t),y()),n,o);o.getInitialState=()=>h;let f;const I=()=>{var t,v;if(!u)return;m=!1,l.forEach(s=>{var a;return s((a=n())!=null?a:h)});const g=((v=e.onRehydrateStorage)==null?void 0:v.call(e,(t=n())!=null?t:h))||void 0;return S(u.getItem.bind(u))(e.name).then(s=>{if(s)if(typeof s.version=="number"&&s.version!==e.version){if(e.migrate){const a=e.migrate(s.state,s.version);return a instanceof Promise?a.then(p=>[!0,p]):[!0,a]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,s.state];return[!1,void 0]}).then(s=>{var a;const[p,b]=s;if(f=e.merge(b,(a=n())!=null?a:h),r(f,!0),p)return y()}).then(()=>{g?.(f,void 0),f=n(),m=!0,d.forEach(s=>s(f))}).catch(s=>{g?.(void 0,s)})};return o.persist={setOptions:t=>{e={...e,...t},t.storage&&(u=t.storage)},clearStorage:()=>{u?.removeItem(e.name)},getOptions:()=>e,rehydrate:()=>I(),hasHydrated:()=>m,onHydrate:t=>(l.add(t),()=>{l.delete(t)}),onFinishHydration:t=>(d.add(t),()=>{d.delete(t)})},e.skipHydration||I(),f||h},F=w,N=H()(F(i=>({user:null,setUser:c=>i({user:c})}),{name:"user-storage"}));export{N as u};
