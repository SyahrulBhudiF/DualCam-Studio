import{a1 as Tt,r as T,j as P}from"./main-DZWvjlLQ.js";import{a as It}from"./button-DhTWMI0i.js";import{c as Dt}from"./utils-CwvXAYlB.js";const B=new WeakMap,J=new WeakMap,Z={current:[]};let at=!1,W=0;const U=new Set,z=new Map;function yt(s){const r=Array.from(s).sort((e,t)=>e instanceof L&&e.options.deps.includes(t)?1:t instanceof L&&t.options.deps.includes(e)?-1:0);for(const e of r){if(Z.current.includes(e))continue;Z.current.push(e),e.recompute();const t=J.get(e);if(t)for(const i of t){const n=B.get(i);n&&yt(n)}}}function kt(s){const r={prevVal:s.prevState,currentVal:s.state};for(const e of s.listeners)e(r)}function _t(s){const r={prevVal:s.prevState,currentVal:s.state};for(const e of s.listeners)e(r)}function Vt(s){if(W>0&&!z.has(s)&&z.set(s,s.prevState),U.add(s),!(W>0)&&!at)try{for(at=!0;U.size>0;){const r=Array.from(U);U.clear();for(const e of r){const t=z.get(e)??e.prevState;e.prevState=t,kt(e)}for(const e of r){const t=B.get(e);t&&(Z.current.push(e),yt(t))}for(const e of r){const t=B.get(e);if(t)for(const i of t)_t(i)}}}finally{at=!1,Z.current=[],z.clear()}}function A(s){W++;try{s()}finally{if(W--,W===0){const r=U.values().next().value;r&&Vt(r)}}}function Ot(s){return typeof s=="function"}class tt{constructor(r,e){this.listeners=new Set,this.subscribe=t=>{var i,n;this.listeners.add(t);const a=(n=(i=this.options)==null?void 0:i.onSubscribe)==null?void 0:n.call(i,t,this);return()=>{this.listeners.delete(t),a?.()}},this.prevState=r,this.state=r,this.options=e}setState(r){var e,t,i;this.prevState=this.state,(e=this.options)!=null&&e.updateFn?this.state=this.options.updateFn(this.prevState)(r):Ot(r)?this.state=r(this.prevState):this.state=r,(i=(t=this.options)==null?void 0:t.onUpdate)==null||i.call(t),Vt(this)}}class L{constructor(r){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const e=this.options.deps.length,t=new Array(e),i=new Array(e);for(let n=0;n<e;n++){const a=this.options.deps[n];t[n]=a.prevState,i[n]=a.state}return this.lastSeenDepValues=i,{prevDepVals:t,currDepVals:i,prevVal:this.prevState??void 0}},this.recompute=()=>{var e,t;this.prevState=this.state;const i=this.getDepVals();this.state=this.options.fn(i),(t=(e=this.options).onUpdate)==null||t.call(e)},this.checkIfRecalculationNeededDeeply=()=>{for(const n of this.options.deps)n instanceof L&&n.checkIfRecalculationNeededDeeply();let e=!1;const t=this.lastSeenDepValues,{currDepVals:i}=this.getDepVals();for(let n=0;n<i.length;n++)if(i[n]!==t[n]){e=!0;break}e&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const e of this._subscriptions)e()}),this.subscribe=e=>{var t,i;this.listeners.add(e);const n=(i=(t=this.options).onSubscribe)==null?void 0:i.call(t,e,this);return()=>{this.listeners.delete(e),n?.()}},this.options=r,this.state=r.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(r=this.options.deps){for(const e of r)if(e instanceof L)e.registerOnGraph(),this.registerOnGraph(e.options.deps);else if(e instanceof tt){let t=B.get(e);t||(t=new Set,B.set(e,t)),t.add(this);let i=J.get(this);i||(i=new Set,J.set(this,i)),i.add(e)}}unregisterFromGraph(r=this.options.deps){for(const e of r)if(e instanceof L)this.unregisterFromGraph(e.options.deps);else if(e instanceof tt){const t=B.get(e);t&&t.delete(this);const i=J.get(this);i&&i.delete(e)}}}function Ct(s){return typeof s=="function"}function ft(s,...r){return Ct(s)?s(...r):s}function Pt(s){return s||(typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"")}class St{#s=!0;#t;#e;#n;#i;#r;#a;#l;#c=0;#h=5;#o=!1;#d=()=>{this.debugLog("Connected to event bus"),this.#r=!0,this.#o=!1,this.debugLog("Emitting queued events",this.#i),this.#i.forEach(r=>this.emitEventToBus(r)),this.#i=[],this.stopConnectLoop(),this.#e().removeEventListener("tanstack-connect-success",this.#d)};#u=()=>{if(this.#c<this.#h){this.#c++,this.dispatchCustomEvent("tanstack-connect",{});return}this.#e().removeEventListener("tanstack-connect",this.#u),this.debugLog("Max retries reached, giving up on connection"),this.stopConnectLoop()};#f=()=>{this.#o||(this.#o=!0,this.#e().addEventListener("tanstack-connect-success",this.#d),this.#u())};constructor({pluginId:r,debug:e=!1,enabled:t=!0,reconnectEveryMs:i=300}){this.#t=r,this.#s=t,this.#e=this.getGlobalTarget,this.#n=e,this.debugLog(" Initializing event subscription for plugin",this.#t),this.#i=[],this.#r=!1,this.#a=null,this.#l=i}startConnectLoop(){this.#a!==null||this.#r||(this.debugLog(`Starting connect loop (every ${this.#l}ms)`),this.#a=setInterval(this.#u,this.#l))}stopConnectLoop(){this.#o=!1,this.#a!==null&&(clearInterval(this.#a),this.#a=null,this.debugLog("Stopped connect loop"))}debugLog(...r){this.#n&&console.log(`ðŸŒ´ [tanstack-devtools:${this.#t}-plugin]`,...r)}getGlobalTarget(){if(typeof globalThis<"u"&&globalThis.__TANSTACK_EVENT_TARGET__)return this.debugLog("Using global event target"),globalThis.__TANSTACK_EVENT_TARGET__;if(typeof window<"u"&&typeof window.addEventListener<"u")return this.debugLog("Using window as event target"),window;const r=typeof EventTarget<"u"?new EventTarget:void 0;return typeof r>"u"||typeof r.addEventListener>"u"?(this.debugLog("No event mechanism available, running in non-web environment"),{addEventListener:()=>{},removeEventListener:()=>{},dispatchEvent:()=>!1}):(this.debugLog("Using new EventTarget as fallback"),r)}getPluginId(){return this.#t}dispatchCustomEventShim(r,e){try{const t=new Event(r,{detail:e});this.#e().dispatchEvent(t)}catch{this.debugLog("Failed to dispatch shim event")}}dispatchCustomEvent(r,e){try{this.#e().dispatchEvent(new CustomEvent(r,{detail:e}))}catch{this.dispatchCustomEventShim(r,e)}}emitEventToBus(r){this.debugLog("Emitting event to client bus",r),this.dispatchCustomEvent("tanstack-dispatch-event",r)}emit(r,e){if(!this.#s){this.debugLog("Event bus client is disabled, not emitting event",r,e);return}if(!this.#r){this.debugLog("Bus not available, will be pushed as soon as connected"),this.#i.push({type:`${this.#t}:${r}`,payload:e,pluginId:this.#t}),typeof CustomEvent<"u"&&!this.#o&&(this.#f(),this.startConnectLoop());return}return this.emitEventToBus({type:`${this.#t}:${r}`,payload:e,pluginId:this.#t})}on(r,e){const t=`${this.#t}:${r}`;if(!this.#s)return this.debugLog("Event bus client is disabled, not registering event",t),()=>{};const i=n=>{this.debugLog("Received event from bus",n.detail),e(n.detail)};return this.#e().addEventListener(t,i),this.debugLog("Registered event to bus",t),()=>{this.#e().removeEventListener(t,i)}}onAll(r){if(!this.#s)return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const e=t=>{const i=t.detail;r(i)};return this.#e().addEventListener("tanstack-devtools-global",e),()=>this.#e().removeEventListener("tanstack-devtools-global",e)}onAllPluginEvents(r){if(!this.#s)return this.debugLog("Event bus client is disabled, not registering event"),()=>{};const e=t=>{const i=t.detail;this.#t&&i.pluginId!==this.#t||r(i)};return this.#e().addEventListener("tanstack-devtools-global",e),()=>this.#e().removeEventListener("tanstack-devtools-global",e)}}class $t extends St{constructor(r){super({pluginId:"pacer",debug:r?.debug})}}const Rt=(s,r)=>{Ft.emit(s,r)},Ft=new $t;function mt(){return{executionCount:0,isPending:!1,lastArgs:void 0,lastExecutionTime:0,nextExecutionTime:0,status:"idle",maybeExecuteCount:0}}const Bt={enabled:!0,leading:!0,trailing:!0,wait:0};class xt{constructor(r,e){this.fn=r,this.store=new tt(mt()),this.setOptions=t=>{this.options={...this.options,...t},this.#e()||this.cancel()},this.#t=t=>{this.store.setState(i=>{const n={...i,...t},{isPending:a}=n;return{...n,status:this.#e()?a?"pending":"idle":"disabled"}}),Rt("Throttler",this)},this.#e=()=>!!ft(this.options.enabled,this),this.#n=()=>ft(this.options.wait,this),this.maybeExecute=(...t)=>{this.#t({maybeExecuteCount:this.store.state.maybeExecuteCount+1});const i=Date.now(),n=i-this.store.state.lastExecutionTime,a=this.#n();if(this.options.leading&&n>=a)this.#i(...t);else if(this.#t({lastArgs:t}),!this.#s&&this.options.trailing){const d=this.store.state.lastExecutionTime?i-this.store.state.lastExecutionTime:0,u=a-d;this.#t({isPending:!0}),this.#s=setTimeout(()=>{const{lastArgs:l}=this.store.state;l!==void 0&&this.#i(...l)},u)}},this.#i=(...t)=>{if(!this.#e())return;this.fn(...t);const i=Date.now(),n=i+this.#n();this.#r(),this.#t({executionCount:this.store.state.executionCount+1,lastExecutionTime:i,nextExecutionTime:n,isPending:!1,lastArgs:void 0}),this.options.onExecute?.(t,this),setTimeout(()=>{this.store.state.isPending||this.#t({nextExecutionTime:void 0})},this.#n())},this.flush=()=>{this.store.state.isPending&&this.store.state.lastArgs&&this.#i(...this.store.state.lastArgs)},this.#r=()=>{this.#s&&(clearTimeout(this.#s),this.#s=void 0)},this.cancel=()=>{this.#r(),this.#t({lastArgs:void 0,isPending:!1})},this.reset=()=>{this.#t(mt())},this.key=Pt(e.key),this.options={...Bt,...e},this.#t(this.options.initialState??{}),Ft.on("d-Throttler",t=>{t.payload.key===this.key&&(this.#t(t.payload.store.state),this.setOptions(t.payload.options))})}#s;#t;#e;#n;#i;#r}function Nt(s,r){return new xt(s,r).maybeExecute}function it(s,r){return typeof s=="function"?s(r):s}function K(s,r){return ht(r).reduce((t,i)=>{if(t===null)return null;if(typeof t<"u")return t[i]},s)}function G(s,r,e){const t=ht(r);function i(n){if(!t.length)return it(e,n);const a=t.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(n))return typeof n=="object"?(n===null&&(n={}),{...n,[a]:i(n[a])}):{[a]:i()};if(Array.isArray(n)&&typeof a=="number"){const d=n.slice(0,a);return[...d.length?d:new Array(a),i(n[a]),...n.slice(a+1)]}return[...new Array(a),i()]}return i(s)}function Ut(s,r){const e=ht(r);function t(i){if(!i)return;if(e.length===1){const a=e[0];if(Array.isArray(i)&&typeof a=="number")return i.filter((l,o)=>o!==a);const{[a]:d,...u}=i;return u}const n=e.shift();if(typeof n=="string"&&typeof i=="object")return{...i,[n]:t(i[n])};if(typeof n=="number"&&Array.isArray(i)){if(n>=i.length)return i;const a=i.slice(0,n);return[...a.length?a:new Array(n),t(i[n]),...i.slice(n+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return t(s)}const Wt=/^(\d+)$/gm,zt=/\.(\d+)(?=\.)/gm,Kt=/^(\d+)\./gm,Gt=/\.(\d+$)/gm,jt=/\.{2,}/gm,lt="__int__",j=`${lt}$1`;function ht(s){if(Array.isArray(s))return[...s];if(typeof s!="string")throw new Error("Path must be a string.");return s.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(Wt,j).replace(zt,`.${j}.`).replace(Kt,`${j}.`).replace(Gt,`.${j}`).replace(jt,".").split(".").map(r=>{if(r.startsWith(lt)){const e=r.substring(lt.length),t=parseInt(e,10);return String(t)===e?t:e}return r})}function qt(s){return!(Array.isArray(s)&&s.length===0)}function ut(s,r){const e=t=>t.validators.filter(Boolean).map(i=>({cause:i.cause,validate:i.fn}));return r.validationLogic({form:r.form,validators:r.validators,event:{type:s,async:!1},runValidation:e})}function ct(s,r){const{asyncDebounceMs:e}=r,{onBlurAsyncDebounceMs:t,onChangeAsyncDebounceMs:i,onDynamicAsyncDebounceMs:n}=r.validators||{},a=e??0,d=u=>u.validators.filter(Boolean).map(l=>{const o=l?.cause||s;let h=a;switch(o){case"change":h=i??a;break;case"blur":h=t??a;break;case"dynamic":h=n??a;break;case"submit":h=0;break}return s==="submit"&&(h=0),{cause:o,validate:l.fn,debounceMs:h}});return r.validationLogic({form:r.form,validators:r.validators,event:{type:s,async:!0},runValidation:d})}const dt=s=>!!s&&typeof s=="object"&&"fields"in s;function _(s,r){if(Object.is(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;if(s instanceof Date&&r instanceof Date)return s.getTime()===r.getTime();if(s instanceof Map&&r instanceof Map){if(s.size!==r.size)return!1;for(const[i,n]of s)if(!r.has(i)||!Object.is(n,r.get(i)))return!1;return!0}if(s instanceof Set&&r instanceof Set){if(s.size!==r.size)return!1;for(const i of s)if(!r.has(i))return!1;return!0}const e=Object.keys(s),t=Object.keys(r);if(e.length!==t.length)return!1;for(const i of e)if(!t.includes(i)||!_(s[i],r[i]))return!1;return!0}const vt=({newFormValidatorError:s,isPreviousErrorFromFormValidator:r,previousErrorValue:e})=>s?{newErrorValue:s,newSource:"form"}:r?{newErrorValue:void 0,newSource:void 0}:e?{newErrorValue:e,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},pt=({formLevelError:s,fieldLevelError:r})=>r?{newErrorValue:r,newSource:"field"}:s?{newErrorValue:s,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function F(s,r){return s==null?r:{...s,...r}}let C=256;const Q=[];let q;for(;C--;)Q[C]=(C+256).toString(16).substring(1);function Ht(){let s=0,r,e="";if(!q||C+16>256){for(q=new Array(256),s=256;s--;)q[s]=256*Math.random()|0;s=0,C=0}for(;s<16;s++)r=q[C+s],s===6?e+=Q[r&15|64]:s===8?e+=Q[r&63|128]:e+=Q[r],s&1&&s>1&&s<11&&(e+="-");return C++,e}const R=s=>{if(!s.validators)return s.runValidation({validators:[],form:s.form});const r=s.event.async,e=r?void 0:{fn:s.validators.onMount,cause:"mount"},t={fn:r?s.validators.onChangeAsync:s.validators.onChange,cause:"change"},i={fn:r?s.validators.onBlurAsync:s.validators.onBlur,cause:"blur"},n={fn:r?s.validators.onSubmitAsync:s.validators.onSubmit,cause:"submit"},a=r?void 0:{fn:()=>{},cause:"server"};switch(s.event.type){case"mount":return s.runValidation({validators:[e],form:s.form});case"submit":return s.runValidation({validators:[t,i,n,a],form:s.form});case"server":return s.runValidation({validators:[],form:s.form});case"blur":return s.runValidation({validators:[i,a],form:s.form});case"change":return s.runValidation({validators:[t,a],form:s.form});default:throw new Error(`Unknown validation event type: ${s.event.type}`)}};function Xt(s,r){const e=new Map;for(const t of s){const i=t.path??[];let n=r,a="";for(let d=0;d<i.length;d++){const u=i[d];if(u===void 0)continue;const l=typeof u=="object"?u.key:u,o=Number(l);Array.isArray(n)&&!Number.isNaN(o)?a+=`[${o}]`:a+=(d>0?".":"")+String(l),typeof n=="object"&&n!==null?n=n[l]:n=void 0}e.set(a,(e.get(a)??[]).concat(t))}return Object.fromEntries(e)}const gt=(s,r)=>{const e=Xt(s,r);return{form:e,fields:e}},x={validate({value:s,validationSource:r},e){const t=e["~standard"].validate(s);if(t instanceof Promise)throw new Error("async function passed to sync validator");if(t.issues)return r==="field"?t.issues:gt(t.issues,s)},async validateAsync({value:s,validationSource:r},e){const t=await e["~standard"].validate(s);if(t.issues)return r==="field"?t.issues:gt(t.issues,s)}},Et=s=>!!s&&"~standard"in s,et={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function H(s){function r(o,h,c){const f=a(o,h,"move",c),m=Math.min(h,c),p=Math.max(h,c);for(let v=m;v<=p;v++)f.push(n(o,v));const M=Object.keys(s.fieldInfo).reduce((v,g)=>(g.startsWith(n(o,h))&&v.set(g,s.getFieldMeta(g)),v),new Map);u(f,h<c?"up":"down"),Object.keys(s.fieldInfo).filter(v=>v.startsWith(n(o,c))).forEach(v=>{const g=v.replace(n(o,c),n(o,h)),y=M.get(g);y&&s.setFieldMeta(v,y)})}function e(o,h){const c=a(o,h,"remove");u(c,"up")}function t(o,h,c){a(o,h,"swap",c).forEach(m=>{if(!m.toString().startsWith(n(o,h)))return;const p=m.toString().replace(n(o,h),n(o,c)),[M,v]=[s.getFieldMeta(m),s.getFieldMeta(p)];M&&s.setFieldMeta(p,M),v&&s.setFieldMeta(m,v)})}function i(o,h){const c=a(o,h,"insert");u(c,"down"),c.forEach(f=>{f.toString().startsWith(n(o,h))&&s.setFieldMeta(f,l())})}function n(o,h){return`${o}[${h}]`}function a(o,h,c,f){const m=[n(o,h)];switch(c){case"swap":m.push(n(o,f));break;case"move":{const[p,M]=[Math.min(h,f),Math.max(h,f)];for(let v=p;v<=M;v++)m.push(n(o,v));break}default:{const p=s.getFieldValue(o),M=Array.isArray(p)?p.length:0;for(let v=h+1;v<M;v++)m.push(n(o,v));break}}return Object.keys(s.fieldInfo).filter(p=>m.some(M=>p.startsWith(M)))}function d(o,h){return o.replace(/\[(\d+)\]/,(c,f)=>{const m=parseInt(f,10);return`[${h==="up"?m+1:Math.max(0,m-1)}]`})}function u(o,h){(h==="up"?o:[...o].reverse()).forEach(f=>{const m=d(f.toString(),h),p=s.getFieldMeta(m);p?s.setFieldMeta(f,p):s.setFieldMeta(f,l())})}const l=()=>et;return{handleArrayMove:r,handleArrayRemove:e,handleArraySwap:t,handleArrayInsert:i}}class Jt extends St{constructor(){super({pluginId:"form-devtools",reconnectEveryMs:1e3})}}const w=new Jt;function ot(s){return{values:s.values??{},errorMap:s.errorMap??{},fieldMetaBase:s.fieldMetaBase??{},isSubmitted:s.isSubmitted??!1,isSubmitting:s.isSubmitting??!1,isValidating:s.isValidating??!1,submissionAttempts:s.submissionAttempts??0,isSubmitSuccessful:s.isSubmitSuccessful??!1,validationMetaMap:s.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}}}class Qt{constructor(r){this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{const t=this.fieldMetaDerived.mount(),i=this.store.mount(),n=()=>{t(),i(),w.emit("form-unmounted",{id:this._formId})};this.options.listeners?.onMount?.({formApi:this});const{onMount:a}=this.options.validators||{};return w.emit("form-api",{id:this._formId,state:this.store.state,options:this.options}),a&&this.validateSync("mount"),n},this.update=t=>{if(!t)return;const i=this.options;this.options=t;const n=!!t.transform?.deps?.some((u,l)=>u!==this.prevTransformArray[l]),a=t.defaultValues&&!_(t.defaultValues,i.defaultValues)&&!this.state.isTouched,d=!_(t.defaultState,i.defaultState)&&!this.state.isTouched;!a&&!d&&!n||(A(()=>{this.baseStore.setState(()=>ot(Object.assign({},this.state,d?t.defaultState:{},a?{values:t.defaultValues}:{},n?{_force_re_eval:!this.state._force_re_eval}:{})))}),w.emit("form-api",{id:this._formId,state:this.store.state,options:this.options}))},this.reset=(t,i)=>{const{fieldMeta:n}=this.state,a=this.resetFieldMeta(n);t&&!i?.keepDefaultValues&&(this.options={...this.options,defaultValues:t}),this.baseStore.setState(()=>ot({...this.options.defaultState,values:t??this.options.defaultValues??this.options.defaultState?.values,fieldMetaBase:a}))},this.validateAllFields=async t=>{const i=[];return A(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const d=a.instance;i.push(Promise.resolve().then(()=>d.validate(t,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(u=>({...u,isTouched:!0}))})}),(await Promise.all(i)).flat()},this.validateArrayFieldsStartingFrom=async(t,i,n)=>{const a=this.getFieldValue(t),d=Array.isArray(a)?Math.max(a.length-1,0):null,u=[`${t}[${i}]`];for(let c=i+1;c<=(d??0);c++)u.push(`${t}[${c}]`);const l=Object.keys(this.fieldInfo).filter(c=>u.some(f=>c.startsWith(f))),o=[];return A(()=>{l.forEach(c=>{o.push(Promise.resolve().then(()=>this.validateField(c,n)))})}),(await Promise.all(o)).flat()},this.validateField=(t,i)=>{const n=this.fieldInfo[t]?.instance;return n?(n.state.meta.isTouched||n.setMeta(a=>({...a,isTouched:!0})),n.validate(i)):[]},this.validateSync=t=>{const i=ut(t,{...this.options,form:this,validationLogic:this.options.validationLogic||R});let n=!1;const a={};return A(()=>{for(const l of i){if(!l.validate)continue;const o=this.runValidator({validate:l.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:c}=Y(o),f=N(l.cause);for(const m of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[m]===void 0)continue;const p=this.getFieldMeta(m);if(!p)continue;const{errorMap:M,errorSourceMap:v}=p,g=c?.[m],{newErrorValue:y,newSource:S}=vt({newFormValidatorError:g,isPreviousErrorFromFormValidator:v?.[f]==="form",previousErrorValue:M?.[f]});S==="form"&&(a[m]={...a[m],[f]:g}),M?.[f]!==y&&this.setFieldMeta(m,V=>({...V,errorMap:{...V.errorMap,[f]:y},errorSourceMap:{...V.errorSourceMap,[f]:S}}))}this.state.errorMap?.[f]!==h&&this.baseStore.setState(m=>({...m,errorMap:{...m.errorMap,[f]:h}})),(h||c)&&(n=!0)}const d=N("submit");this.state.errorMap?.[d]&&t!=="submit"&&!n&&this.baseStore.setState(l=>({...l,errorMap:{...l.errorMap,[d]:void 0}}));const u=N("server");this.state.errorMap?.[u]&&t!=="server"&&!n&&this.baseStore.setState(l=>({...l,errorMap:{...l.errorMap,[u]:void 0}}))}),{hasErrored:n,fieldsErrorMap:a}},this.validateAsync=async t=>{const i=ct(t,{...this.options,form:this,validationLogic:this.options.validationLogic||R});this.state.isFormValidating||this.baseStore.setState(l=>({...l,isFormValidating:!0}));const n=[];let a;for(const l of i){if(!l.validate)continue;const o=N(l.cause);this.state.validationMetaMap[o]?.lastAbortController.abort();const c=new AbortController;this.state.validationMetaMap[o]={lastAbortController:c},n.push(new Promise(async f=>{let m;try{m=await new Promise((g,y)=>{setTimeout(async()=>{if(c.signal.aborted)return g(void 0);try{g(await this.runValidator({validate:l.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:c.signal},type:"validateAsync"}))}catch(S){y(S)}},l.debounceMs)})}catch(g){m=g}const{formError:p,fieldErrors:M}=Y(m);M&&(a=a?{...a,...M}:M);const v=N(l.cause);for(const g of Object.keys(this.state.fieldMeta)){if(this.baseStore.state.fieldMetaBase[g]===void 0)continue;const y=this.getFieldMeta(g);if(!y)continue;const{errorMap:S,errorSourceMap:V}=y,I=a?.[g],{newErrorValue:D,newSource:E}=vt({newFormValidatorError:I,isPreviousErrorFromFormValidator:V?.[v]==="form",previousErrorValue:S?.[v]});S?.[v]!==D&&this.setFieldMeta(g,k=>({...k,errorMap:{...k.errorMap,[v]:D},errorSourceMap:{...k.errorSourceMap,[v]:E}}))}this.baseStore.setState(g=>({...g,errorMap:{...g.errorMap,[v]:p}})),f(a?{fieldErrors:a,errorMapKey:v}:void 0)}))}let d=[];const u={};if(n.length){d=await Promise.all(n);for(const l of d)if(l?.fieldErrors){const{errorMapKey:o}=l;for(const[h,c]of Object.entries(l.fieldErrors)){const m={...u[h]||{},[o]:c};u[h]=m}}}return this.baseStore.setState(l=>({...l,isFormValidating:!1})),u},this.validate=t=>{const{hasErrored:i,fieldsErrorMap:n}=this.validateSync(t);return i&&!this.options.asyncAlways?n:this.validateAsync(t)},this.getFieldValue=t=>K(this.state.values,t),this.getFieldMeta=t=>this.state.fieldMeta[t],this.getFieldInfo=t=>this.fieldInfo[t]||={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0,onDynamic:void 0}},this.setFieldMeta=(t,i)=>{this.baseStore.setState(n=>({...n,fieldMetaBase:{...n.fieldMetaBase,[t]:it(i,n.fieldMetaBase[t])}}))},this.resetFieldMeta=t=>Object.keys(t).reduce((i,n)=>{const a=n;return i[a]=et,i},{}),this.setFieldValue=(t,i,n)=>{const a=n?.dontUpdateMeta??!1,d=n?.dontRunListeners??!1,u=n?.dontValidate??!1;A(()=>{a||this.setFieldMeta(t,l=>({...l,isTouched:!0,isDirty:!0,errorMap:{...l?.errorMap,onMount:void 0}})),this.baseStore.setState(l=>({...l,values:G(l.values,t,i)}))}),d||this.getFieldInfo(t).instance?.triggerOnChangeListener(),u||this.validateField(t,"change")},this.deleteField=t=>{const n=[...Object.keys(this.fieldInfo).filter(a=>{const d=t.toString();return a!==d&&a.startsWith(d)}),t];this.baseStore.setState(a=>{const d={...a};return n.forEach(u=>{d.values=Ut(d.values,u),delete this.fieldInfo[u],delete d.fieldMetaBase[u]}),d})},this.pushFieldValue=(t,i,n)=>{this.setFieldValue(t,a=>[...Array.isArray(a)?a:[],i],n)},this.insertFieldValue=async(t,i,n,a)=>{this.setFieldValue(t,u=>[...u.slice(0,i),n,...u.slice(i)],F(a,{dontValidate:!0}));const d=a?.dontValidate??!1;d||await this.validateField(t,"change"),H(this).handleArrayInsert(t,i),d||await this.validateArrayFieldsStartingFrom(t,i,"change")},this.replaceFieldValue=async(t,i,n,a)=>{this.setFieldValue(t,u=>u.map((l,o)=>o===i?n:l),F(a,{dontValidate:!0})),(a?.dontValidate??!1)||(await this.validateField(t,"change"),await this.validateArrayFieldsStartingFrom(t,i,"change"))},this.removeFieldValue=async(t,i,n)=>{const a=this.getFieldValue(t),d=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(t,l=>l.filter((o,h)=>h!==i),F(n,{dontValidate:!0})),H(this).handleArrayRemove(t,i),d!==null){const l=`${t}[${d}]`;this.deleteField(l)}(n?.dontValidate??!1)||(await this.validateField(t,"change"),await this.validateArrayFieldsStartingFrom(t,i,"change"))},this.swapFieldValues=(t,i,n,a)=>{this.setFieldValue(t,u=>{const l=u[i],o=u[n];return G(G(u,`${i}`,o),`${n}`,l)},F(a,{dontValidate:!0})),H(this).handleArraySwap(t,i,n),(a?.dontValidate??!1)||(this.validateField(t,"change"),this.validateField(`${t}[${i}]`,"change"),this.validateField(`${t}[${n}]`,"change"))},this.moveFieldValues=(t,i,n,a)=>{this.setFieldValue(t,u=>{const l=[...u];return l.splice(n,0,l.splice(i,1)[0]),l},F(a,{dontValidate:!0})),H(this).handleArrayMove(t,i,n),(a?.dontValidate??!1)||(this.validateField(t,"change"),this.validateField(`${t}[${i}]`,"change"),this.validateField(`${t}[${n}]`,"change"))},this.clearFieldValues=(t,i)=>{const n=this.getFieldValue(t),a=Array.isArray(n)?Math.max(n.length-1,0):null;if(this.setFieldValue(t,[],F(i,{dontValidate:!0})),a!==null)for(let u=0;u<=a;u++){const l=`${t}[${u}]`;this.deleteField(l)}(i?.dontValidate??!1)||this.validateField(t,"change")},this.resetField=t=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[t]:et},values:this.options.defaultValues?G(i.values,t,K(this.options.defaultValues,t)):i.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((t,[i,n])=>(Object.keys(n).length&&n.errors.length&&(t[i]={errors:n.errors,errorMap:n.errorMap}),t),{})}),this.parseValuesWithSchema=t=>x.validate({value:this.state.values,validationSource:"form"},t),this.parseValuesWithSchemaAsync=t=>x.validateAsync({value:this.state.values,validationSource:"form"},t),this.timeoutIds={validations:{},listeners:{},formListeners:{}},this._formId=r?.formId??Ht(),this._devtoolsSubmissionOverride=!1,this.baseStore=new tt(ot({...r?.defaultState,values:r?.defaultValues??r?.defaultState?.values})),this.fieldMetaDerived=new L({deps:[this.baseStore],fn:({prevDepVals:t,currDepVals:i,prevVal:n})=>{const a=n,d=t?.[0],u=i[0];let l=0;const o={};for(const h of Object.keys(u.fieldMetaBase)){const c=u.fieldMetaBase[h],f=d?.fieldMetaBase[h],m=a?.[h],p=K(u.values,h);let M=m?.errors;if(!f||c.errorMap!==f.errorMap){M=Object.values(c.errorMap??{}).filter(V=>V!==void 0);const S=this.getFieldInfo(h)?.instance;S&&!S.options.disableErrorFlat&&(M=M.flat(1))}const v=!qt(M),g=!c.isDirty,y=_(p,K(this.options.defaultValues,h))||_(p,this.getFieldInfo(h)?.instance?.options.defaultValue);if(m&&m.isPristine===g&&m.isValid===v&&m.isDefaultValue===y&&m.errors===M&&c===f){o[h]=m,l++;continue}o[h]={...c,errors:M??[],isPristine:g,isValid:v,isDefaultValue:y}}return Object.keys(u.fieldMetaBase).length&&a&&l===Object.keys(u.fieldMetaBase).length?a:o}}),this.store=new L({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:t,currDepVals:i,prevVal:n})=>{const a=n,d=t?.[0],u=i[0],l=i[1],o=Object.values(l).filter(Boolean),h=o.some(b=>b.isValidating),c=o.every(b=>b.isValid),f=o.some(b=>b.isTouched),m=o.some(b=>b.isBlurred),p=o.every(b=>b.isDefaultValue),M=f&&u.errorMap?.onMount,v=o.some(b=>b.isDirty),g=!v,y=!!(u.errorMap?.onMount||o.some(b=>b?.errorMap?.onMount)),S=!!h;let V=a?.errors??[];(!d||u.errorMap!==d.errorMap)&&(V=Object.values(u.errorMap).reduce((b,O)=>O===void 0?b:O&&dt(O)?(b.push(O.form),b):(b.push(O),b),[]));const I=V.length===0,D=c&&I,E=this.options.canSubmitWhenInvalid??!1,k=u.submissionAttempts===0&&!f&&!y||!S&&!u.isSubmitting&&D||E;let $=u.errorMap;if(M&&(V=V.filter(b=>b!==u.errorMap.onMount),$=Object.assign($,{onMount:void 0})),a&&d&&a.errorMap===$&&a.fieldMeta===this.fieldMetaDerived.state&&a.errors===V&&a.isFieldsValidating===h&&a.isFieldsValid===c&&a.isFormValid===I&&a.isValid===D&&a.canSubmit===k&&a.isTouched===f&&a.isBlurred===m&&a.isPristine===g&&a.isDefaultValue===p&&a.isDirty===v&&_(d,u))return a;let rt={...u,errorMap:$,fieldMeta:this.fieldMetaDerived.state,errors:V,isFieldsValidating:h,isFieldsValid:c,isFormValid:I,isValid:D,canSubmit:k,isTouched:f,isBlurred:m,isPristine:g,isDefaultValue:p,isDirty:v};const nt=this.options.transform?.deps??[];if(nt.length!==this.prevTransformArray.length||nt.some((b,O)=>b!==this.prevTransformArray[O])){const b=Object.assign({},this,{state:rt});this.options.transform?.fn(b),rt=b.state,this.prevTransformArray=nt}return rt}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(r||{});const e=Nt(t=>w.emit("form-state",{id:this._formId,state:t}),{wait:300});this.store.subscribe(()=>{e(this.store.state)}),w.on("request-form-state",t=>{t.payload.id===this._formId&&w.emit("form-api",{id:this._formId,state:this.store.state,options:this.options})}),w.on("request-form-reset",t=>{t.payload.id===this._formId&&this.reset()}),w.on("request-form-force-submit",t=>{t.payload.id===this._formId&&(this._devtoolsSubmissionOverride=!0,this.handleSubmit(),this._devtoolsSubmissionOverride=!1)})}get state(){return this.store.state}get formId(){return this._formId}runValidator(r){return Et(r.validate)?x[r.type](r.value,r.validate):r.validate(r.value)}async handleSubmit(r){this.baseStore.setState(i=>({...i,isSubmitted:!1,submissionAttempts:i.submissionAttempts+1,isSubmitSuccessful:!1})),A(()=>{Object.values(this.fieldInfo).forEach(i=>{i.instance&&(i.instance.state.meta.isTouched||i.instance.setMeta(n=>({...n,isTouched:!0})))})});const e=r??this.options.onSubmitMeta;if(!this.state.canSubmit&&!this._devtoolsSubmissionOverride){this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e});return}this.baseStore.setState(i=>({...i,isSubmitting:!0}));const t=()=>{this.baseStore.setState(i=>({...i,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){t(),this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e}),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validateAllFields",errors:Object.values(this.state.fieldMeta).map(i=>i.errors).flat()});return}if(await this.validate("submit"),!this.state.isValid){t(),this.options.onSubmitInvalid?.({value:this.state.values,formApi:this,meta:e}),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"validate",errors:this.state.errors});return}A(()=>{Object.values(this.fieldInfo).forEach(i=>{i.instance?.options.listeners?.onSubmit?.({value:i.instance.state.value,fieldApi:i.instance})})}),this.options.listeners?.onSubmit?.({formApi:this,meta:e});try{await this.options.onSubmit?.({value:this.state.values,formApi:this,meta:e}),A(()=>{this.baseStore.setState(i=>({...i,isSubmitted:!0,isSubmitSuccessful:!0})),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!0}),t()})}catch(i){throw this.baseStore.setState(n=>({...n,isSubmitSuccessful:!1})),w.emit("form-submission",{id:this._formId,submissionAttempt:this.state.submissionAttempts,successful:!1,stage:"inflight",onError:i}),t(),i}}setErrorMap(r){A(()=>{Object.entries(r).forEach(([e,t])=>{const i=e;if(dt(t)){const{formError:n,fieldErrors:a}=Y(t);for(const d of Object.keys(this.fieldInfo))this.getFieldMeta(d)&&this.setFieldMeta(d,l=>({...l,errorMap:{...l.errorMap,[i]:a?.[d]},errorSourceMap:{...l.errorSourceMap,[i]:"form"}}));this.baseStore.setState(d=>({...d,errorMap:{...d.errorMap,[i]:n}}))}else this.baseStore.setState(n=>({...n,errorMap:{...n.errorMap,[i]:t}}))})})}}function Y(s){if(s){if(dt(s)){const r=Y(s.form).formError,e=s.fields;return{formError:r,fieldErrors:e}}return{formError:s}}return{formError:void 0}}function N(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}class Yt{constructor(r){this.options={},this.mount=()=>{const e=this.store.mount();this.options.defaultValue!==void 0&&!this.getMeta().isTouched&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const t=this.getInfo();t.instance=this,this.update(this.options);const{onMount:i}=this.options.validators||{};if(i){const n=this.runValidator({validate:i,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});n&&this.setMeta(a=>({...a,errorMap:{...a?.errorMap,onMount:n},errorSourceMap:{...a?.errorSourceMap,onMount:"field"}}))}return this.options.listeners?.onMount?.({value:this.state.value,fieldApi:this}),e},this.update=e=>{if(this.options=e,this.name=e.name,!this.state.meta.isTouched&&this.options.defaultValue!==void 0){const t=this.form.getFieldValue(this.name);_(t,e.defaultValue)||this.form.setFieldValue(this.name,e.defaultValue,{dontUpdateMeta:!0,dontValidate:!0,dontRunListeners:!0})}this.form.getFieldMeta(this.name)||this.form.setFieldMeta(this.name,this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(e,t)=>{this.form.setFieldValue(this.name,e,F(t,{dontRunListeners:!0,dontValidate:!0})),t?.dontRunListeners||this.triggerOnChangeListener(),t?.dontValidate||this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=e=>this.form.setFieldMeta(this.name,e),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(e,t)=>{this.form.pushFieldValue(this.name,e,F(t,{dontRunListeners:!0})),t?.dontRunListeners||this.triggerOnChangeListener()},this.insertValue=(e,t,i)=>{this.form.insertFieldValue(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.replaceValue=(e,t,i)=>{this.form.replaceFieldValue(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.removeValue=(e,t)=>{this.form.removeFieldValue(this.name,e,F(t,{dontRunListeners:!0})),t?.dontRunListeners||this.triggerOnChangeListener()},this.swapValues=(e,t,i)=>{this.form.swapFieldValues(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.moveValue=(e,t,i)=>{this.form.moveFieldValues(this.name,e,t,F(i,{dontRunListeners:!0})),i?.dontRunListeners||this.triggerOnChangeListener()},this.clearValues=e=>{this.form.clearFieldValues(this.name,F(e,{dontRunListeners:!0})),e?.dontRunListeners||this.triggerOnChangeListener()},this.getLinkedFields=e=>{const t=Object.values(this.form.fieldInfo),i=[];for(const n of t){if(!n.instance)continue;const{onChangeListenTo:a,onBlurListenTo:d}=n.instance.options.validators||{};e==="change"&&a?.includes(this.name)&&i.push(n.instance),e==="blur"&&d?.includes(this.name)&&i.push(n.instance)}return i},this.validateSync=(e,t)=>{const i=ut(e,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||R}),a=this.getLinkedFields(e).reduce((l,o)=>{const h=ut(e,{...o.options,form:o.form,validationLogic:o.form.options.validationLogic||R});return h.forEach(c=>{c.field=o}),l.concat(h)},[]);let d=!1;A(()=>{const l=(o,h)=>{const c=X(h.cause),f=h.validate?Mt(o.runValidator({validate:h.validate,value:{value:o.store.state.value,validationSource:"field",fieldApi:o},type:"validate"})):void 0,m=t[c],{newErrorValue:p,newSource:M}=pt({formLevelError:m,fieldLevelError:f});o.state.meta.errorMap?.[c]!==p&&o.setMeta(v=>({...v,errorMap:{...v.errorMap,[c]:p},errorSourceMap:{...v.errorSourceMap,[c]:M}})),p&&(d=!0)};for(const o of i)l(this,o);for(const o of a)o.validate&&l(o.field,o)});const u=X("submit");return this.state.meta.errorMap?.[u]&&e!=="submit"&&!d&&this.setMeta(l=>({...l,errorMap:{...l.errorMap,[u]:void 0},errorSourceMap:{...l.errorSourceMap,[u]:void 0}})),{hasErrored:d}},this.validateAsync=async(e,t)=>{const i=ct(e,{...this.options,form:this.form,validationLogic:this.form.options.validationLogic||R}),n=await t,a=this.getLinkedFields(e),d=a.reduce((c,f)=>{const m=ct(e,{...f.options,form:f.form,validationLogic:f.form.options.validationLogic||R});return m.forEach(p=>{p.field=f}),c.concat(m)},[]);this.state.meta.isValidating||this.setMeta(c=>({...c,isValidating:!0}));for(const c of a)c.setMeta(f=>({...f,isValidating:!0}));const u=[],l=[],o=(c,f,m)=>{const p=X(f.cause);c.getInfo().validationMetaMap[p]?.lastAbortController.abort();const v=new AbortController;this.getInfo().validationMetaMap[p]={lastAbortController:v},m.push(new Promise(async g=>{let y;try{y=await new Promise((E,k)=>{this.timeoutIds.validations[f.cause]&&clearTimeout(this.timeoutIds.validations[f.cause]),this.timeoutIds.validations[f.cause]=setTimeout(async()=>{if(v.signal.aborted)return E(void 0);try{E(await this.runValidator({validate:f.validate,value:{value:c.store.state.value,fieldApi:c,signal:v.signal,validationSource:"field"},type:"validateAsync"}))}catch($){k($)}},f.debounceMs)})}catch(E){y=E}if(v.signal.aborted)return g(void 0);const S=Mt(y),V=n[this.name]?.[p],{newErrorValue:I,newSource:D}=pt({formLevelError:V,fieldLevelError:S});c.setMeta(E=>({...E,errorMap:{...E?.errorMap,[p]:I},errorSourceMap:{...E.errorSourceMap,[p]:D}})),g(I)}))};for(const c of i)c.validate&&o(this,c,u);for(const c of d)c.validate&&o(c.field,c,l);let h=[];(u.length||l.length)&&(h=await Promise.all(u),await Promise.all(l)),this.setMeta(c=>({...c,isValidating:!1}));for(const c of a)c.setMeta(f=>({...f,isValidating:!1}));return h.filter(Boolean)},this.validate=(e,t)=>{if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=t?.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(e),{hasErrored:n}=this.validateSync(e,i[this.name]??{});if(n&&!this.options.asyncAlways)return this.getInfo().validationMetaMap[X(e)]?.lastAbortController.abort(),this.state.meta.errors;const a=t?.skipFormValidation?Promise.resolve({}):this.form.validateAsync(e);return this.validateAsync(e,a)},this.handleChange=e=>{this.setValue(e)},this.handleBlur=()=>{this.state.meta.isTouched||this.setMeta(t=>({...t,isTouched:!0})),this.state.meta.isBlurred||this.setMeta(t=>({...t,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=e=>x.validate({value:this.state.value,validationSource:"field"},e),this.parseValueWithSchemaAsync=e=>x.validateAsync({value:this.state.value,validationSource:"field"},e),this.form=r.form,this.name=r.name,this.options=r,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new L({deps:[this.form.store],fn:()=>{const e=this.form.getFieldMeta(this.name)??{...et,...r.defaultMeta};let t=this.form.getFieldValue(this.name);return!e.isTouched&&t===void 0&&this.options.defaultValue!==void 0&&!_(t,this.options.defaultValue)&&(t=this.options.defaultValue),{value:t,meta:e}}})}get state(){return this.store.state}runValidator(r){return Et(r.validate)?x[r.type](r.value,r.validate):r.validate(r.value)}setErrorMap(r){this.setMeta(e=>({...e,errorMap:{...e.errorMap,...r}}))}triggerOnBlurListener(){const r=this.form.options.listeners?.onBlurDebounceMs;r&&r>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this})},r)):this.form.options.listeners?.onBlur?.({formApi:this.form,fieldApi:this});const e=this.options.listeners?.onBlurDebounceMs;e&&e>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})},e)):this.options.listeners?.onBlur?.({value:this.state.value,fieldApi:this})}triggerOnChangeListener(){const r=this.form.options.listeners?.onChangeDebounceMs;r&&r>0?(this.timeoutIds.formListeners.change&&clearTimeout(this.timeoutIds.formListeners.change),this.timeoutIds.formListeners.change=setTimeout(()=>{this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this})},r)):this.form.options.listeners?.onChange?.({formApi:this.form,fieldApi:this});const e=this.options.listeners?.onChangeDebounceMs;e&&e>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})},e)):this.options.listeners?.onChange?.({value:this.state.value,fieldApi:this})}}function Mt(s){if(s)return s}function X(s){switch(s){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"dynamic":return"onDynamic";case"change":default:return"onChange"}}function wt(s,r=e=>e){return Tt.useSyncExternalStoreWithSelector(s.subscribe,()=>s.state,()=>s.state,r,Zt)}function Zt(s,r){if(Object.is(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;if(s instanceof Map&&r instanceof Map){if(s.size!==r.size)return!1;for(const[t,i]of s)if(!r.has(t)||!Object.is(i,r.get(t)))return!1;return!0}if(s instanceof Set&&r instanceof Set){if(s.size!==r.size)return!1;for(const t of s)if(!r.has(t))return!1;return!0}if(s instanceof Date&&r instanceof Date)return s.getTime()===r.getTime();const e=bt(s);if(e.length!==bt(r).length)return!1;for(let t=0;t<e.length;t++)if(!Object.prototype.hasOwnProperty.call(r,e[t])||!Object.is(s[e[t]],r[e[t]]))return!1;return!0}function bt(s){return Object.keys(s).concat(Object.getOwnPropertySymbols(s))}const st=typeof window<"u"?T.useLayoutEffect:T.useEffect;function te(s){const r=T.useRef(s);r.current=s;const e=T.useMemo(()=>{const i=new Yt({...r.current,form:s.form,name:s.name});return i.Field=At,i},[s.form,s.name]);return st(e.mount,[e]),st(()=>{e.update(s)}),wt(e.store,s.mode==="array"?t=>[t.meta,Object.keys(t.value??[]).length]:void 0),e}const At=(({children:s,...r})=>{const e=te(r),t=T.useMemo(()=>it(s,e),[s,e,e.state.value,e.state.meta]);return P.jsx(P.Fragment,{children:t})});function ee({form:s,selector:r,children:e}){const t=wt(s.store,r);return it(e,t)}function ce(s){const r=T.useId(),[e]=T.useState(()=>{const t=new Qt({...s,formId:r}),i=t;return i.Field=function(a){return P.jsx(At,{...a,form:t})},i.Subscribe=function(a){return P.jsx(ee,{form:t,selector:a.selector,children:a.children})},i});return st(e.mount,[]),st(()=>{e.update(s)}),e}var se=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ie=se.reduce((s,r)=>{const e=It(`Primitive.${r}`),t=T.forwardRef((i,n)=>{const{asChild:a,...d}=i,u=a?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),P.jsx(u,{...d,ref:n})});return t.displayName=`Primitive.${r}`,{...s,[r]:t}},{}),re="Label",Lt=T.forwardRef((s,r)=>P.jsx(ie.label,{...s,ref:r,onMouseDown:e=>{e.target.closest("button, input, select, textarea")||(s.onMouseDown?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));Lt.displayName=re;var ne=Lt;function de({className:s,...r}){return P.jsx(ne,{"data-slot":"label",className:Dt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...r})}export{de as L,ce as u};
