import{c as x,j as e,r as k,L as I,N as $}from"./main-DZWvjlLQ.js";import{M as A}from"./main-Bsmmwh1x.js";import{B as M}from"./button-DhTWMI0i.js";import{B as _}from"./badge-Ohhm4MUd.js";import{C as h,a as j,b as g,c as f,d as N}from"./card-CksVaWOc.js";import{f as P,V as Q}from"./format-CjtGFxja.js";import{C as z,b as D}from"./calendar-6rLOrFiO.js";import{f as L,g as H,h as B,i as E}from"./index-YHAXHqCs.js";import{T as F,a as O,b as q,c as S,d as U,e as w,f as C,g as V,h as y,i as v}from"./tabs-DwpOdH4M.js";import{S as G,a as J,b as X,c as K,d as W}from"./select-DCsT-fDP.js";import{A as Y}from"./arrow-left-DXVb_zBZ.js";import"./utils-CwvXAYlB.js";import"./xlsx-BsqxREE8.js";import"./dropdown-menu-CWLiXjqn.js";import"./index-COLG3_It.js";import"./index-tXSsdQnT.js";import"./chevron-right-BziTW__y.js";import"./index-xaBr0Lpv.js";const Z=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ee=x("circle-check-big",Z);const se=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],ne=x("graduation-cap",se);const te=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],ie=x("hash",te);const ae=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],re=x("mail",ae);const de=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],le=x("maximize",de);const ce=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],oe=x("pause",ce);const me=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],xe=x("play",me);const ue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],T=x("user",ue);const he=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],je=x("users",he);const ge=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],fe=x("volume-2",ge);const Ne=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],ye=x("volume-x",Ne);function ve({profile:s,createdAt:d,questionnaireTitle:a}){return s?e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),s.name??"Unknown"]}),e.jsx(f,{children:"Respondent Profile"})]}),e.jsx(_,{variant:"outline",className:"text-xs",children:P(new Date(d),"dd MMM yyyy HH:mm")})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Email"}),e.jsx("div",{className:"text-sm font-medium",children:s.email})]})]}),s.nim&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"NIM"}),e.jsx("div",{className:"text-sm font-medium",children:s.nim})]})]}),s.class&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Class"}),e.jsx("div",{className:"text-sm font-medium",children:s.class})]})]}),s.semester&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Semester"}),e.jsx("div",{className:"text-sm font-medium",children:s.semester})]})]}),s.gender&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Gender"}),e.jsx("div",{className:"text-sm font-medium",children:s.gender})]})]}),s.age&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Age"}),e.jsxs("div",{className:"text-sm font-medium",children:[s.age," years"]})]})]})]}),a&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Questionnaire"}),e.jsx("div",{className:"text-sm font-medium",children:a})]})]})]}):e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Respondent Profile"}),e.jsx(f,{children:"Profile information not available"})]}),e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"No profile data"})})]})}function m({src:s,title:d}){const a=k.useRef(null),[t,n]=k.useState(!1),[c,u]=k.useState(!1),i=()=>{const l=a.current;l&&(t?l.pause():l.play(),n(!t))},p=()=>{const l=a.current;l&&(l.muted=!c,u(!c))},o=()=>{const l=a.current;l&&l.requestFullscreen&&l.requestFullscreen()};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"relative rounded-lg overflow-hidden bg-black aspect-video",children:e.jsx("video",{ref:a,src:s||void 0,className:"w-full h-full object-contain",onPlay:()=>n(!0),onPause:()=>n(!1),onEnded:()=>n(!1)})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(M,{variant:"outline",size:"sm",onClick:i,className:"cursor-pointer",children:t?e.jsx(oe,{className:"h-4 w-4"}):e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"sm",onClick:p,className:"cursor-pointer",children:c?e.jsx(ye,{className:"h-4 w-4"}):e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(M,{variant:"outline",size:"sm",onClick:o,className:"cursor-pointer",children:e.jsx(le,{className:"h-4 w-4"})})]})]})}function pe({details:s,totalScore:d,videoData:a}){const[t,n]=k.useState(null),c=[...s].sort((r,b)=>(r.orderNumber??0)-(b.orderNumber??0)),u=s.reduce((r,b)=>r+(b.maxScore??0),0),i=a?.mode==="segmented",p=r=>!i||!a?.segmentedVideos?null:a.segmentedVideos.find(b=>b.questionId===r),o=t?p(t):null,l=t?s.find(r=>r.questionId===t):null;return e.jsxs(e.Fragment,{children:[e.jsxs(h,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Response Answers"}),e.jsxs(f,{children:["All answers submitted for this questionnaire",i&&" (with video per question)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold",children:d}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Total Score ",u>0&&`/ ${u}`]})]})]})}),e.jsx(N,{children:s.length===0?e.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"No answer details available"}):e.jsxs(F,{children:[e.jsx(O,{children:e.jsxs(q,{children:[e.jsx(S,{className:"w-[60px]",children:"#"}),e.jsx(S,{children:"Question"}),e.jsx(S,{children:"Answer"}),e.jsx(S,{className:"w-[100px] text-right",children:"Score"}),i&&e.jsx(S,{className:"w-[80px] text-center",children:"Video"})]})}),e.jsx(U,{children:c.map((r,b)=>{const R=i&&p(r.questionId);return e.jsxs(q,{children:[e.jsx(w,{className:"font-medium",children:r.orderNumber??b+1}),e.jsx(w,{children:e.jsx("div",{className:"max-w-md",children:r.questionText??"-"})}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:r.answerText??"-"})]})}),e.jsx(w,{className:"text-right",children:e.jsx(_,{variant:r.score>0?"default":"secondary",children:r.score})}),i&&e.jsx(w,{className:"text-center",children:R?e.jsx(M,{variant:"ghost",size:"sm",className:"cursor-pointer",onClick:()=>n(r.questionId),children:e.jsx(Q,{className:"h-4 w-4"})}):e.jsx("span",{className:"text-muted-foreground text-xs",children:"-"})})]},r.id)})})]})})]}),e.jsx(L,{open:!!t,onOpenChange:r=>!r&&n(null),children:e.jsxs(H,{className:"max-w-4xl",children:[e.jsx(B,{children:e.jsxs(E,{children:["Question ",l?.orderNumber??""," Video"]})}),l&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg mb-4",children:[e.jsx("div",{className:"text-sm font-medium",children:l.questionText}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Answer: ",l.answerText," (Score:"," ",l.score,")"]})]}),o&&e.jsxs(C,{defaultValue:"main",children:[e.jsxs(V,{className:"mb-4",children:[e.jsx(y,{value:"main",children:"Main Camera"}),e.jsx(y,{value:"secondary",children:"Secondary Camera"}),e.jsx(y,{value:"side-by-side",children:"Side by Side"})]}),e.jsx(v,{value:"main",children:o.main?e.jsx(m,{src:o.main,title:"Main Camera"}):e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"Main video not available"})})}),e.jsx(v,{value:"secondary",children:o.secondary?e.jsx(m,{src:o.secondary,title:"Secondary Camera"}):e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"Secondary video not available"})})}),e.jsx(v,{value:"side-by-side",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Main Camera"}),o.main?e.jsx(m,{src:o.main,title:"Main Side"}):e.jsx("div",{className:"flex items-center justify-center h-32 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground text-sm",children:"Not available"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Secondary Camera"}),o.secondary?e.jsx(m,{src:o.secondary,title:"Secondary Side"}):e.jsx("div",{className:"flex items-center justify-center h-32 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground text-sm",children:"Not available"})})]})]})})]})]})})]})}function be({videos:s,details:d}){const[a,t]=k.useState(s.length>0?s[0].questionId:"");if(s.length===0)return e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Video Recording"}),e.jsx(f,{children:"Segmented video recordings"})]}),e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"No segmented videos available"})})})]});const n=s.find(i=>i.questionId===a),c=d.find(i=>i.questionId===a),u=i=>{const o=d.find(r=>r.questionId===i.questionId)?.questionText??`Question ${i.questionNumber}`,l=o.length>40?`${o.substring(0,40)}...`:o;return`Q${i.questionNumber}: ${l}`};return e.jsxs(h,{children:[e.jsx(j,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(g,{children:"Segmented Video Recordings"}),e.jsxs(f,{children:["Video recordings per question (",s.length," questions)"]})]})})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs(G,{value:a,onValueChange:t,children:[e.jsx(J,{className:"w-full",children:e.jsx(X,{placeholder:"Select a question"})}),e.jsx(K,{children:s.map(i=>e.jsx(W,{value:i.questionId,children:u(i)},i.questionId))})]}),n&&e.jsxs("div",{className:"space-y-4",children:[c&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Question ",n.questionNumber]}),e.jsx("div",{className:"text-sm font-medium",children:c.questionText}),c.answerText&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Answer: ",c.answerText," (Score:"," ",c.score,")"]})]}),e.jsxs(C,{defaultValue:"main",children:[e.jsxs(V,{className:"mb-4",children:[e.jsx(y,{value:"main",children:"Main Camera"}),e.jsx(y,{value:"secondary",children:"Secondary Camera"}),e.jsx(y,{value:"side-by-side",children:"Side by Side"})]}),e.jsx(v,{value:"main",children:n.main?e.jsx(m,{src:n.main,title:`Q${n.questionNumber} Main`}):e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"Main video not available"})})}),e.jsx(v,{value:"secondary",children:n.secondary?e.jsx(m,{src:n.secondary,title:`Q${n.questionNumber} Secondary`}):e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"Secondary video not available"})})}),e.jsx(v,{value:"side-by-side",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Main Camera"}),n.main?e.jsx(m,{src:n.main,title:`Q${n.questionNumber} Main Side`}):e.jsx("div",{className:"flex items-center justify-center h-32 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground text-sm",children:"Not available"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Secondary Camera"}),n.secondary?e.jsx(m,{src:n.secondary,title:`Q${n.questionNumber} Secondary Side`}):e.jsx("div",{className:"flex items-center justify-center h-32 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground text-sm",children:"Not available"})})]})]})})]})]})]})]})}function Se({videoPath:s}){if(!s)return e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Video Recording"}),e.jsx(f,{children:"No video available for this response"})]}),e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"No video recorded"})})})]});const d=s.main&&s.main!=="null",a=s.secondary&&s.secondary!=="null";if(!d&&!a)return e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Video Recording"}),e.jsx(f,{children:"No video available for this response"})]}),e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-48 bg-muted rounded-lg",children:e.jsx("span",{className:"text-muted-foreground",children:"No video recorded"})})})]});const t=s.main??"",n=s.secondary??"";return d&&!a?e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Video Recording"}),e.jsx(f,{children:"Main camera recording"})]}),e.jsx(N,{children:e.jsx(m,{src:t,title:"Main Camera"})})]}):!d&&a?e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Video Recording"}),e.jsx(f,{children:"Secondary camera recording"})]}),e.jsx(N,{children:e.jsx(m,{src:n,title:"Secondary Camera"})})]}):e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Video Recording"}),e.jsx(f,{children:"View recordings from both cameras"})]}),e.jsx(N,{children:e.jsxs(C,{defaultValue:"main",children:[e.jsxs(V,{className:"mb-4",children:[e.jsx(y,{value:"main",children:"Main Camera"}),e.jsx(y,{value:"secondary",children:"Secondary Camera"}),e.jsx(y,{value:"side-by-side",children:"Side by Side"})]}),e.jsx(v,{value:"main",children:e.jsx(m,{src:t,title:"Main Camera"})}),e.jsx(v,{value:"secondary",children:e.jsx(m,{src:n,title:"Secondary Camera"})}),e.jsx(v,{value:"side-by-side",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Main Camera"}),e.jsx(m,{src:t,title:"Main Side"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Secondary Camera"}),e.jsx(m,{src:n,title:"Secondary Side"})]})]})})]})})]})}function we(s,d){if(!s||s==="null")return{mode:"full",fullVideo:void 0};if(d.some(t=>t.videoSegmentPath&&t.videoSegmentPath!=="null"))return{mode:"segmented",segmentedVideos:d.filter(n=>n.videoSegmentPath&&n.videoSegmentPath!=="null").sort((n,c)=>(n.orderNumber??0)-(c.orderNumber??0)).map((n,c)=>{let u=null,i=null;try{const p=JSON.parse(n.videoSegmentPath);u=p.main??null,i=p.secondary??null}catch{u=n.videoSegmentPath}return{questionId:n.questionId,questionNumber:n.orderNumber??c+1,main:u,secondary:i}})};try{const t=JSON.parse(s);return{mode:"full",fullVideo:{main:t.main??null,secondary:t.secondary??null}}}catch{return{mode:"full",fullVideo:{main:s,secondary:null}}}}function ke({response:s}){const d=we(s.videoPath,s.details);return e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{to:"/admin/responses",children:e.jsxs(M,{variant:"ghost",size:"sm",className:"cursor-pointer",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Back to Responses"]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Response Detail"}),e.jsx("p",{className:"text-muted-foreground",children:"View complete response information"})]})]}),e.jsx(D,{response:s})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsx(ve,{profile:s.profile,createdAt:s.createdAt,questionnaireTitle:s.questionnaire?.title??null}),d.mode==="full"?e.jsx(Se,{videoPath:d.fullVideo??null}):e.jsx(be,{videos:d.segmentedVideos??[],details:s.details})]}),e.jsx(pe,{details:s.details,totalScore:s.totalScore,videoData:d})]})}function Fe(){const{response:s}=$.useLoaderData();return e.jsx(ke,{response:s})}export{Fe as component};
